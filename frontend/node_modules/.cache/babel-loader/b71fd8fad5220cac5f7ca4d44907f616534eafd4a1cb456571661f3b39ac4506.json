{"ast":null,"code":"import _objectSpread from\"/Users/anshul/Documents/Assignments/assignment/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import'./App.css';import FilterBar from'./components/FilterBar';import LogList from'./components/LogList';import LogChart from'./components/LogChart';import Notification from'./components/Notification';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[logs,setLogs]=useState([]);const[loading,setLoading]=useState(false);const[error,setError]=useState(null);const[filters,setFilters]=useState({message:'',level:'',resourceId:'',timestampStart:'',timestampEnd:''});const[wsConnected,setWsConnected]=useState(false);const[notifications,setNotifications]=useState([]);const fetchLogs=async function(){let filterParams=arguments.length>0&&arguments[0]!==undefined?arguments[0]:filters;setLoading(true);setError(null);try{const queryParams=new URLSearchParams();if(filterParams.message)queryParams.append('message',filterParams.message);if(filterParams.level)queryParams.append('level',filterParams.level);if(filterParams.resourceId)queryParams.append('resourceId',filterParams.resourceId);if(filterParams.timestampStart)queryParams.append('timestamp_start',filterParams.timestampStart);if(filterParams.timestampEnd)queryParams.append('timestamp_end',filterParams.timestampEnd);const queryString=queryParams.toString();const url=queryString?\"/logs?\".concat(queryString):'/logs';const response=await fetch(url);if(!response.ok){throw new Error(\"HTTP error! status: \".concat(response.status));}const data=await response.json();setLogs(data);}catch(err){setError(err.message);}finally{setLoading(false);}};useEffect(()=>{fetchLogs();const ws=new WebSocket('ws://localhost:3000');ws.onopen=()=>{console.log('WebSocket connection established');setWsConnected(true);};ws.onmessage=event=>{try{const message=JSON.parse(event.data);if(message.type==='NEW_LOG'){const newLog=message.data;setLogs(prevLogs=>{const exists=prevLogs.find(log=>log.id===newLog.id);if(!exists){addNotification(\"New \".concat(newLog.level,\" log received: \").concat(newLog.message.substring(0,50)).concat(newLog.message.length>50?'...':''),'success');return[newLog,...prevLogs];}return prevLogs;});}}catch(error){console.error('Error parsing WebSocket message:',error);}};ws.onclose=()=>{console.log('WebSocket connection closed');setWsConnected(false);};ws.onerror=error=>{console.error('WebSocket error:',error);setWsConnected(false);};return()=>{ws.close();};},[]);useEffect(()=>{const timeoutId=setTimeout(()=>{fetchLogs(filters);},300);return()=>clearTimeout(timeoutId);},[filters]);const handleFilterChange=(key,value)=>{setFilters(prev=>_objectSpread(_objectSpread({},prev),{},{[key]:value}));};const handleClearFilters=()=>{setFilters({message:'',level:'',resourceId:'',timestampStart:'',timestampEnd:''});};const addNotification=function(message){let type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'info';const id=Date.now();setNotifications(prev=>[...prev,{id,message,type}]);};const removeNotification=id=>{setNotifications(prev=>prev.filter(notification=>notification.id!==id));};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"App-header\",children:/*#__PURE__*/_jsx(\"h1\",{children:\"Logs Viewer\"})}),/*#__PURE__*/_jsx(FilterBar,{filters:filters,onFilterChange:handleFilterChange,onClearFilters:handleClearFilters}),/*#__PURE__*/_jsx(LogChart,{logs:logs,filters:filters}),/*#__PURE__*/_jsx(LogList,{logs:logs,loading:loading,error:error,onRefresh:fetchLogs,wsConnected:wsConnected}),notifications.map(notification=>/*#__PURE__*/_jsx(Notification,{message:notification.message,type:notification.type,onClose:()=>removeNotification(notification.id)},notification.id))]});}export default App;","map":{"version":3,"names":["React","useState","useEffect","FilterBar","LogList","LogChart","Notification","jsx","_jsx","jsxs","_jsxs","App","logs","setLogs","loading","setLoading","error","setError","filters","setFilters","message","level","resourceId","timestampStart","timestampEnd","wsConnected","setWsConnected","notifications","setNotifications","fetchLogs","filterParams","arguments","length","undefined","queryParams","URLSearchParams","append","queryString","toString","url","concat","response","fetch","ok","Error","status","data","json","err","ws","WebSocket","onopen","console","log","onmessage","event","JSON","parse","type","newLog","prevLogs","exists","find","id","addNotification","substring","onclose","onerror","close","timeoutId","setTimeout","clearTimeout","handleFilterChange","key","value","prev","_objectSpread","handleClearFilters","Date","now","removeNotification","filter","notification","className","children","onFilterChange","onClearFilters","onRefresh","map","onClose"],"sources":["/Users/anshul/Documents/Assignments/assignment/frontend/src/App.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport './App.css';\nimport FilterBar from './components/FilterBar';\nimport LogList from './components/LogList';\nimport LogChart from './components/LogChart';\nimport Notification from './components/Notification';\n\nfunction App() {\n  const [logs, setLogs] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [filters, setFilters] = useState({\n    message: '',\n    level: '',\n    resourceId: '',\n    timestampStart: '',\n    timestampEnd: ''\n  });\n  const [wsConnected, setWsConnected] = useState(false);\n  const [notifications, setNotifications] = useState([]);\n\n  const fetchLogs = async (filterParams = filters) => {\n    setLoading(true);\n    setError(null);\n    \n    try {\n      const queryParams = new URLSearchParams();\n      \n      if (filterParams.message) queryParams.append('message', filterParams.message);\n      if (filterParams.level) queryParams.append('level', filterParams.level);\n      if (filterParams.resourceId) queryParams.append('resourceId', filterParams.resourceId);\n      if (filterParams.timestampStart) queryParams.append('timestamp_start', filterParams.timestampStart);\n      if (filterParams.timestampEnd) queryParams.append('timestamp_end', filterParams.timestampEnd);\n      \n      const queryString = queryParams.toString();\n      const url = queryString ? `/logs?${queryString}` : '/logs';\n      \n      const response = await fetch(url);\n      \n      if (!response.ok) {\n        throw new Error(`HTTP error! status: ${response.status}`);\n      }\n      \n      const data = await response.json();\n      setLogs(data);\n    } catch (err) {\n      setError(err.message);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  useEffect(() => {\n    fetchLogs();\n    \n    const ws = new WebSocket('ws://localhost:3000');\n    \n    ws.onopen = () => {\n      console.log('WebSocket connection established');\n      setWsConnected(true);\n    };\n    \n    ws.onmessage = (event) => {\n      try {\n        const message = JSON.parse(event.data);\n        if (message.type === 'NEW_LOG') {\n          const newLog = message.data;\n          setLogs(prevLogs => {\n            const exists = prevLogs.find(log => log.id === newLog.id);\n            if (!exists) {\n              addNotification(\n                `New ${newLog.level} log received: ${newLog.message.substring(0, 50)}${newLog.message.length > 50 ? '...' : ''}`,\n                'success'\n              );\n              return [newLog, ...prevLogs];\n            }\n            return prevLogs;\n          });\n        }\n      } catch (error) {\n        console.error('Error parsing WebSocket message:', error);\n      }\n    };\n    \n    ws.onclose = () => {\n      console.log('WebSocket connection closed');\n      setWsConnected(false);\n    };\n    \n    ws.onerror = (error) => {\n      console.error('WebSocket error:', error);\n      setWsConnected(false);\n    };\n    \n    return () => {\n      ws.close();\n    };\n  }, []);\n\n  useEffect(() => {\n    const timeoutId = setTimeout(() => {\n      fetchLogs(filters);\n    }, 300);\n\n    return () => clearTimeout(timeoutId);\n  }, [filters]);\n\n  const handleFilterChange = (key, value) => {\n    setFilters(prev => ({\n      ...prev,\n      [key]: value\n    }));\n  };\n\n  const handleClearFilters = () => {\n    setFilters({\n      message: '',\n      level: '',\n      resourceId: '',\n      timestampStart: '',\n      timestampEnd: ''\n    });\n  };\n\n  const addNotification = (message, type = 'info') => {\n    const id = Date.now();\n    setNotifications(prev => [...prev, { id, message, type }]);\n  };\n\n  const removeNotification = (id) => {\n    setNotifications(prev => prev.filter(notification => notification.id !== id));\n  };\n\n\n\n  return (\n    <div className=\"App\">\n      <header className=\"App-header\">\n        <h1>Logs Viewer</h1>\n      </header>\n      \n            <FilterBar \n        filters={filters}\n        onFilterChange={handleFilterChange}\n        onClearFilters={handleClearFilters}\n      />\n      \n      <LogChart \n        logs={logs}\n        filters={filters}\n      />\n      \n      <LogList \n        logs={logs}\n        loading={loading}\n        error={error}\n        onRefresh={fetchLogs}\n        wsConnected={wsConnected}\n      />\n      \n      {notifications.map(notification => (\n        <Notification\n          key={notification.id}\n          message={notification.message}\n          type={notification.type}\n          onClose={() => removeNotification(notification.id)}\n        />\n      ))}\n    </div>\n  );\n}\n\nexport default App; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}